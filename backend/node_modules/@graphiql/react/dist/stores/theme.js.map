{"version":3,"file":"theme.js","sources":["../../src/stores/theme.ts"],"sourcesContent":["import type * as monaco from 'monaco-editor';\nimport { STORAGE_KEY, MONACO_THEME_NAME } from '../constants';\nimport { monacoStore } from './monaco';\nimport type { StateCreator } from 'zustand';\nimport type { SlicesWithActions, Theme } from '../types';\n\ntype MonacoTheme =\n  | monaco.editor.BuiltinTheme\n  | (typeof MONACO_THEME_NAME)[keyof typeof MONACO_THEME_NAME]\n  | ({} & string);\n\nexport interface ThemeSlice {\n  theme: Theme;\n\n  monacoTheme?: MonacoTheme;\n}\n\nexport interface ThemeActions {\n  /**\n   * Set a new theme\n   */\n  setTheme: (newTheme: Theme) => void;\n}\n\nexport interface ThemeProps {\n  /**\n   * @default null\n   */\n  defaultTheme?: Theme;\n\n  /**\n   * Sets the color theme for the monaco editors.\n   * @default { dark: 'graphiql-DARK', light: 'graphiql-LIGHT' }\n   */\n  editorTheme?: {\n    dark: MonacoTheme;\n    light: MonacoTheme;\n  };\n}\n\ntype CreateThemeSlice = (\n  initial: Pick<ThemeProps, 'editorTheme'>,\n) => StateCreator<\n  SlicesWithActions,\n  [],\n  [],\n  ThemeSlice & {\n    actions: ThemeActions;\n  }\n>;\n\nexport const createThemeSlice: CreateThemeSlice =\n  ({ editorTheme }) =>\n  (set, get) => ({\n    theme: null,\n    actions: {\n      setTheme(theme) {\n        const { storage } = get();\n        storage.set(STORAGE_KEY.theme, theme ?? '');\n        document.body.classList.remove('graphiql-light', 'graphiql-dark');\n        if (theme) {\n          document.body.classList.add(`graphiql-${theme}`);\n        }\n        const { monaco } = monacoStore.getState();\n        const resolvedTheme = theme ?? getSystemTheme();\n        const monacoTheme = editorTheme![resolvedTheme];\n        monaco?.editor.setTheme(monacoTheme);\n        set({ theme, monacoTheme });\n      },\n    },\n  });\n\n/**\n * Get the resolved theme - dark or light\n * @see https://github.com/pacocoursey/next-themes/blob/c89d0191ce0f19215d7ddfa9eb28e1e4f94d37e5/next-themes/src/index.tsx#L255\n */\nfunction getSystemTheme() {\n  const mediaQueryList = window.matchMedia('(prefers-color-scheme: dark)');\n  const isDark = mediaQueryList.matches;\n  const systemTheme = isDark ? 'dark' : 'light';\n  return systemTheme;\n}\n"],"names":["createThemeSlice","editorTheme","set","get","theme","actions","setTheme","storage","STORAGE_KEY","document","body","classList","remove","add","monaco","monacoStore","getState","resolvedTheme","getSystemTheme","monacoTheme","editor","mediaQueryList","window","matchMedia","isDark","matches","systemTheme"],"mappings":";;AAmDO,MAAMA,mBACXA,CAAC;AAAA,EAAEC;AAAY,MACf,CAACC,KAAKC,SAAS;AAAA,EACbC,OAAO;AAAA,EACPC,SAAS;AAAA,IACPC,SAASF,OAAO;AACR,YAAA;AAAA,QAAEG;AAAAA,UAAYJ,IAAI;AACxBI,cAAQL,IAAIM,YAAYJ,OAAOA,SAAS,EAAE;AAC1CK,eAASC,KAAKC,UAAUC,OAAO,kBAAkB,eAAe;AAChE,UAAIR,OAAO;AACTK,iBAASC,KAAKC,UAAUE,IAAI,YAAYT,KAAK,EAAE;AAAA,MAAA;AAE3C,YAAA;AAAA,QAAEU;AAAAA,MAAAA,IAAWC,YAAYC,SAAS;AAClCC,YAAAA,gBAAgBb,SAASc,eAAe;AACxCC,YAAAA,cAAclB,YAAagB,aAAa;AACtCG,uCAAAA,OAAOd,SAASa;AACpB,UAAA;AAAA,QAAEf;AAAAA,QAAOe;AAAAA,MAAAA,CAAa;AAAA,IAAA;AAAA,EAC5B;AAEJ;AAMF,SAASD,iBAAiB;AAClBG,QAAAA,iBAAiBC,OAAOC,WAAW,8BAA8B;AACvE,QAAMC,SAASH,eAAeI;AACxBC,QAAAA,cAAcF,SAAS,SAAS;AAC/BE,SAAAA;AACT;"}