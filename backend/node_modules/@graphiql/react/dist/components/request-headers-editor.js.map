{"version":3,"file":"request-headers-editor.js","sources":["../../src/components/request-headers-editor.tsx"],"sourcesContent":["import { FC, useEffect, useRef } from 'react';\nimport { useGraphiQL, useGraphiQLActions } from './provider';\nimport type { EditorProps } from '../types';\nimport { URI_NAME, KEY_BINDINGS, STORAGE_KEY } from '../constants';\nimport {\n  getOrCreateModel,\n  createEditor,\n  useChangeHandler,\n  onEditorContainerKeyDown,\n  pick,\n  cleanupDisposables,\n  cn,\n} from '../utility';\nimport { useMonaco } from '../stores';\n\ninterface RequestHeadersEditorProps extends EditorProps {\n  /**\n   * Invoked when the contents of the request headers editor change.\n   * @param value - The new contents of the editor.\n   */\n  onEdit?(value: string): void;\n}\n\nexport const RequestHeadersEditor: FC<RequestHeadersEditorProps> = ({\n  onEdit,\n  ...props\n}) => {\n  const { setEditor, run, prettifyEditors, mergeQuery } = useGraphiQLActions();\n  const { initialHeaders, shouldPersistHeaders, uriInstanceId } = useGraphiQL(\n    pick('initialHeaders', 'shouldPersistHeaders', 'uriInstanceId'),\n  );\n  const ref = useRef<HTMLDivElement>(null!);\n  const monaco = useMonaco(state => state.monaco);\n  useChangeHandler(\n    onEdit,\n    shouldPersistHeaders ? STORAGE_KEY.headers : null,\n    'headers',\n  );\n  useEffect(() => {\n    if (!monaco) {\n      return;\n    }\n    const model = getOrCreateModel({\n      uri: `${uriInstanceId}${URI_NAME.requestHeaders}`,\n      value: initialHeaders,\n    });\n    const editor = createEditor(ref, { model });\n    setEditor({ headerEditor: editor });\n    const disposables = [\n      editor.addAction({ ...KEY_BINDINGS.runQuery, run }),\n      editor.addAction({ ...KEY_BINDINGS.prettify, run: prettifyEditors }),\n      editor.addAction({ ...KEY_BINDINGS.mergeFragments, run: mergeQuery }),\n      editor,\n      model,\n    ];\n    return cleanupDisposables(disposables);\n  }, [monaco]); // eslint-disable-line react-hooks/exhaustive-deps -- only on mount\n\n  return (\n    <div\n      ref={ref}\n      tabIndex={0}\n      onKeyDown={onEditorContainerKeyDown}\n      {...props}\n      className={cn('graphiql-editor', props.className)}\n    />\n  );\n};\n"],"names":["RequestHeadersEditor","t0","$","_c","onEdit","props","setEditor","run","prettifyEditors","mergeQuery","useGraphiQLActions","t1","Symbol","for","pick","initialHeaders","shouldPersistHeaders","uriInstanceId","useGraphiQL","ref","useRef","monaco","useMonaco","_temp","useChangeHandler","STORAGE_KEY","headers","t2","model","getOrCreateModel","uri","URI_NAME","requestHeaders","value","editor","createEditor","headerEditor","disposables","addAction","KEY_BINDINGS","runQuery","prettify","mergeFragments","cleanupDisposables","t3","useEffect","t4","className","cn","t5","onEditorContainerKeyDown","state"],"mappings":"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"}