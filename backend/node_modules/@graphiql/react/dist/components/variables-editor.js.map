{"version":3,"file":"variables-editor.js","sources":["../../src/components/variables-editor.tsx"],"sourcesContent":["import { FC, useEffect, useRef } from 'react';\nimport { useGraphiQL, useGraphiQLActions } from './provider';\nimport type { EditorProps } from '../types';\nimport { KEY_BINDINGS, STORAGE_KEY, URI_NAME } from '../constants';\nimport {\n  getOrCreateModel,\n  createEditor,\n  useChangeHandler,\n  onEditorContainerKeyDown,\n  cleanupDisposables,\n  cn,\n  pick,\n} from '../utility';\nimport { useMonaco } from '../stores';\n\ninterface VariablesEditorProps extends EditorProps {\n  /**\n   * Invoked when the contents of the variables' editor change.\n   * @param value - The new contents of the editor.\n   */\n  onEdit?(value: string): void;\n}\n\nexport const VariablesEditor: FC<VariablesEditorProps> = ({\n  onEdit,\n  ...props\n}) => {\n  const { setEditor, run, prettifyEditors, mergeQuery } = useGraphiQLActions();\n  const { initialVariables, uriInstanceId } = useGraphiQL(\n    pick('initialVariables', 'uriInstanceId'),\n  );\n  const ref = useRef<HTMLDivElement>(null!);\n  const monaco = useMonaco(state => state.monaco);\n  useChangeHandler(onEdit, STORAGE_KEY.variables, 'variables');\n  useEffect(() => {\n    if (!monaco) {\n      return;\n    }\n    const model = getOrCreateModel({\n      uri: `${uriInstanceId}${URI_NAME.variables}`,\n      value: initialVariables,\n    });\n    const editor = createEditor(ref, { model });\n    setEditor({ variableEditor: editor });\n    const disposables = [\n      editor.addAction({ ...KEY_BINDINGS.runQuery, run }),\n      editor.addAction({ ...KEY_BINDINGS.prettify, run: prettifyEditors }),\n      editor.addAction({ ...KEY_BINDINGS.mergeFragments, run: mergeQuery }),\n      editor,\n      model,\n    ];\n    return cleanupDisposables(disposables);\n  }, [monaco]); // eslint-disable-line react-hooks/exhaustive-deps -- only on mount\n\n  return (\n    <div\n      ref={ref}\n      tabIndex={0}\n      onKeyDown={onEditorContainerKeyDown}\n      {...props}\n      className={cn('graphiql-editor', props.className)}\n    />\n  );\n};\n"],"names":["VariablesEditor","t0","$","_c","onEdit","props","setEditor","run","prettifyEditors","mergeQuery","useGraphiQLActions","t1","Symbol","for","pick","initialVariables","uriInstanceId","useGraphiQL","ref","useRef","monaco","useMonaco","_temp","STORAGE_KEY","variables","t2","model","getOrCreateModel","uri","URI_NAME","value","editor","createEditor","variableEditor","disposables","addAction","KEY_BINDINGS","runQuery","prettify","mergeFragments","cleanupDisposables","t3","useEffect","t4","className","cn","t5","onEditorContainerKeyDown","state"],"mappings":"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"}