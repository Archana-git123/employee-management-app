{"version":3,"file":"image-preview.js","sources":["../../src/components/image-preview.tsx"],"sourcesContent":["import { FC, useEffect, useRef, useState } from 'react';\n\ninterface ImagePreviewProps {\n  path: string;\n}\n\ninterface Dimensions {\n  width: number | null;\n  height: number | null;\n}\n\nconst ImagePreview_: FC<ImagePreviewProps> = ({ path }) => {\n  const [{ width, height }, setDimensions] = useState<Dimensions>({\n    width: null,\n    height: null,\n  });\n  const [mime, setMime] = useState<string | null>(null);\n  const ref = useRef<HTMLImageElement>(null!);\n  const src = pathToURL(path)?.href;\n\n  useEffect(() => {\n    if (!src) {\n      setDimensions({ width: null, height: null });\n      setMime(null);\n      return;\n    }\n\n    fetch(src, { method: 'HEAD' })\n      .then(response => {\n        setMime(response.headers.get('Content-Type'));\n      })\n      .catch(() => {\n        setMime(null);\n      });\n  }, [src]);\n\n  return (\n    <div>\n      <img\n        alt=\"\"\n        onLoad={() => {\n          setDimensions({\n            width: ref.current.naturalWidth,\n            height: ref.current.naturalHeight,\n          });\n        }}\n        ref={ref}\n        src={src}\n      />\n      {width !== null && height !== null && (\n        <div>\n          {width}x{height}\n          {mime && ' ' + mime}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport const ImagePreview = Object.assign(ImagePreview_, {\n  shouldRender(path: string) {\n    const url = pathToURL(path);\n    return url ? /\\.(bmp|gif|jpe?g|png|svg|webp)$/.test(url.pathname) : false;\n  },\n});\n\nfunction pathToURL(path: string) {\n  const value = path.slice(1).trim();\n  try {\n    return new URL(value, location.protocol + '//' + location.host);\n  } catch {}\n}\n"],"names":["ImagePreview_","t0","$","_c","path","t1","Symbol","for","width","height","t2","setDimensions","useState","mime","setMime","ref","useRef","src","pathToURL","href","t3","t4","fetch","method","then","response","headers","get","catch","useEffect","t5","current","naturalWidth","naturalHeight","t6","t7","t8","ImagePreview","Object","assign","shouldRender","url","test","pathname","value","slice","trim","URL","location","protocol","host"],"mappings":"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"}