{"version":3,"file":"provider.js","sources":["../../src/components/provider.tsx"],"sourcesContent":["/* eslint sort-keys: \"error\" */\nimport type { FC, ReactNode, RefObject } from 'react';\nimport {\n  createContext,\n  useContext,\n  useRef,\n  useEffect,\n  useId,\n  useState,\n} from 'react';\nimport { create, useStore, UseBoundStore, StoreApi } from 'zustand';\nimport { useShallow } from 'zustand/shallow';\nimport { StorageAPI } from '@graphiql/toolkit';\nimport {\n  createEditorSlice,\n  createExecutionSlice,\n  createPluginSlice,\n  createSchemaSlice,\n  createThemeSlice,\n  createStorageSlice,\n  EditorProps,\n  ExecutionProps,\n  PluginProps,\n  SchemaProps,\n  ThemeProps,\n  StorageProps,\n  useMonaco,\n} from '../stores';\nimport type { SlicesWithActions } from '../types';\nimport { useDidUpdate } from '../utility';\nimport {\n  FragmentDefinitionNode,\n  parse,\n  visit,\n  isSchema,\n  validateSchema,\n} from 'graphql';\nimport {\n  DEFAULT_PRETTIFY_QUERY,\n  DEFAULT_QUERY,\n  MONACO_THEME_NAME,\n  STORAGE_KEY,\n} from '../constants';\nimport { getDefaultTabState } from '../utility/tabs';\n\ninterface GraphiQLProviderProps\n  extends EditorProps,\n    ExecutionProps,\n    PluginProps,\n    SchemaProps,\n    ThemeProps,\n    StorageProps {\n  children: ReactNode;\n}\n\ntype GraphiQLStore = UseBoundStore<StoreApi<SlicesWithActions>>;\n\nconst GraphiQLContext = createContext<RefObject<GraphiQLStore> | null>(null);\n\nexport const GraphiQLProvider: FC<GraphiQLProviderProps> = props => {\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition -- runtime check\n  if (!props.fetcher) {\n    throw new TypeError(\n      'The `GraphiQLProvider` component requires a `fetcher` function to be passed as prop.',\n    );\n  }\n  // @ts-expect-error -- runtime check\n  if (props.validationRules) {\n    throw new TypeError(\n      'The `validationRules` prop has been removed. Use custom GraphQL worker, see https://github.com/graphql/graphiql/tree/main/packages/monaco-graphql#custom-webworker-for-passing-non-static-config-to-worker.',\n    );\n  }\n  // @ts-expect-error -- runtime check\n  if (props.query) {\n    throw new TypeError(\n      'The `query` prop has been removed. Use `initialQuery` prop instead, or set value programmatically using:\\n' +\n        `\nconst queryEditor = useGraphiQL(state => state.queryEditor)\n\nuseEffect(() => {\n  queryEditor.setValue(query)\n}, [query])`,\n    );\n  }\n  // @ts-expect-error -- runtime check\n  if (props.variables) {\n    throw new TypeError(\n      'The `variables` prop has been removed. Use `initialVariables` prop instead, or set value programmatically using:\\n' +\n        `\nconst variableEditor = useGraphiQL(state => state.variableEditor)\n\nuseEffect(() => {\n  variableEditor.setValue(variables)\n}, [variables])`,\n    );\n  }\n  // @ts-expect-error -- runtime check\n  if (props.headers) {\n    throw new TypeError(\n      'The `headers` prop has been removed. Use `initialHeaders` prop instead, or set value programmatically using:\\n' +\n        `\nconst headerEditor = useGraphiQL(state => state.headerEditor)\n\nuseEffect(() => {\n  headerEditor.setValue(headers)\n}, [headers])`,\n    );\n  }\n  // @ts-expect-error -- runtime check\n  if (props.response) {\n    throw new TypeError(\n      'The `response` prop has been removed. Set value programmatically using:\\n' +\n        `\nconst responseEditor = useGraphiQL(state => state.responseEditor)\n\nuseEffect(() => {\n  responseEditor.setValue(response)\n}, [response])`,\n    );\n  }\n  const { actions } = useMonaco();\n  const [mounted, setMounted] = useState(false);\n\n  useEffect(() => {\n    void actions.initialize();\n    setMounted(true);\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // This check due hydration issues, it can be removed after setup zustand persist\n  if (!mounted) {\n    return null;\n  }\n\n  return <InnerGraphiQLProvider {...props} />;\n};\n\nconst InnerGraphiQLProvider: FC<GraphiQLProviderProps> = ({\n  defaultHeaders,\n  defaultQuery = DEFAULT_QUERY,\n  defaultTabs,\n  externalFragments,\n  onEditOperationName,\n  onTabChange,\n  shouldPersistHeaders = false,\n  onCopyQuery,\n  onPrettifyQuery = DEFAULT_PRETTIFY_QUERY,\n\n  dangerouslyAssumeSchemaIsValid = false,\n  fetcher,\n  inputValueDeprecation = false,\n  introspectionQueryName = 'IntrospectionQuery',\n  onSchemaChange,\n  schema,\n  schemaDescription = false,\n\n  getDefaultFieldNames,\n  operationName = null,\n\n  onTogglePluginVisibility,\n  plugins = [],\n  referencePlugin,\n  visiblePlugin,\n  children,\n\n  defaultTheme = null,\n  editorTheme = MONACO_THEME_NAME,\n\n  storage: $storage,\n\n  ...props\n}) => {\n  const storeRef = useRef<GraphiQLStore>(null!);\n  const uriInstanceId = useId();\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition -- false positive\n  if (storeRef.current === null) {\n    const storage = new StorageAPI($storage);\n\n    function getInitialVisiblePlugin() {\n      const storedValue = storage.get(STORAGE_KEY.visiblePlugin);\n      const pluginForStoredValue = plugins.find(\n        plugin => plugin.title === storedValue,\n      );\n      if (pluginForStoredValue) {\n        return pluginForStoredValue;\n      }\n      if (storedValue) {\n        storage.set(STORAGE_KEY.visiblePlugin, '');\n      }\n      return visiblePlugin;\n    }\n\n    function getInitialTheme() {\n      const stored = storage.get(STORAGE_KEY.theme);\n      switch (stored) {\n        case 'light':\n          return 'light';\n        case 'dark':\n          return 'dark';\n        default:\n          if (typeof stored === 'string') {\n            // Remove the invalid stored value\n            storage.set(STORAGE_KEY.theme, '');\n          }\n          return defaultTheme;\n      }\n    }\n\n    function getInitialState() {\n      // We only need to compute it lazily during the initial render.\n      const query = props.initialQuery ?? storage.get(STORAGE_KEY.query);\n      const variables =\n        props.initialVariables ?? storage.get(STORAGE_KEY.variables);\n      const headers = props.initialHeaders ?? storage.get(STORAGE_KEY.headers);\n\n      const { tabs, activeTabIndex } = getDefaultTabState({\n        defaultHeaders,\n        defaultQuery,\n        defaultTabs,\n        headers,\n        query,\n        shouldPersistHeaders,\n        storage,\n        variables,\n      });\n\n      const isStored = storage.get(STORAGE_KEY.persistHeaders) !== null;\n\n      const $shouldPersistHeaders =\n        shouldPersistHeaders !== false && isStored\n          ? storage.get(STORAGE_KEY.persistHeaders) === 'true'\n          : shouldPersistHeaders;\n\n      const store = create<SlicesWithActions>((...args) => {\n        const storageSlice = createStorageSlice({ storage })(...args);\n        const editorSlice = createEditorSlice({\n          activeTabIndex,\n          defaultHeaders,\n          defaultQuery,\n          externalFragments: getExternalFragments(externalFragments),\n          initialHeaders: headers ?? defaultHeaders ?? '',\n          initialQuery:\n            query ?? (activeTabIndex === 0 ? tabs[0]!.query : null) ?? '',\n          initialVariables: variables ?? '',\n          onCopyQuery,\n          onEditOperationName,\n          onPrettifyQuery,\n          onTabChange,\n          shouldPersistHeaders: $shouldPersistHeaders,\n          tabs,\n          /**\n           * Strip colons (React 18) and arrows (React 19) because it breaks monaco-editor\n           * variables autocomplete\n           */\n          uriInstanceId: uriInstanceId.replaceAll(/[:«»]/g, '') + '-',\n        })(...args);\n        const executionSlice = createExecutionSlice({\n          fetcher,\n          getDefaultFieldNames,\n          overrideOperationName: operationName,\n        })(...args);\n        const pluginSlice = createPluginSlice({\n          onTogglePluginVisibility,\n          referencePlugin,\n        })(...args);\n        const schemaSlice = createSchemaSlice({\n          inputValueDeprecation,\n          introspectionQueryName,\n          onSchemaChange,\n          schemaDescription,\n        })(...args);\n        const themeSlice = createThemeSlice({ editorTheme })(...args);\n        return {\n          ...storageSlice,\n          ...editorSlice,\n          ...executionSlice,\n          ...pluginSlice,\n          ...schemaSlice,\n          ...themeSlice,\n          actions: {\n            ...editorSlice.actions,\n            ...executionSlice.actions,\n            ...pluginSlice.actions,\n            ...schemaSlice.actions,\n            ...themeSlice.actions,\n          },\n        };\n      });\n      const { actions } = store.getState();\n      actions.storeTabs({ activeTabIndex, tabs });\n      actions.setPlugins(plugins);\n      actions.setVisiblePlugin(getInitialVisiblePlugin());\n      actions.setTheme(getInitialTheme());\n\n      return store;\n    }\n\n    storeRef.current = getInitialState();\n  }\n  // TODO:\n  // const lastShouldPersistHeadersProp = useRef<boolean | undefined>(undefined);\n  // useEffect(() => {\n  //   const propValue = shouldPersistHeaders;\n  //   if (lastShouldPersistHeadersProp.current !== propValue) {\n  //     editorStore.getState().setShouldPersistHeaders(propValue);\n  //     lastShouldPersistHeadersProp.current = propValue;\n  //   }\n  // }, [shouldPersistHeaders]);\n\n  // Execution sync\n  useDidUpdate(() => {\n    storeRef.current.setState({ fetcher });\n  }, [fetcher]);\n\n  // Plugin sync\n  useDidUpdate(() => {\n    const { actions } = storeRef.current.getState();\n    actions.setPlugins(plugins);\n    actions.setVisiblePlugin(visiblePlugin);\n  }, [plugins, visiblePlugin]);\n\n  /**\n   * Synchronize prop changes with state\n   */\n  useEffect(() => {\n    const newSchema = isSchema(schema) || schema == null ? schema : undefined;\n\n    const validationErrors =\n      !newSchema || dangerouslyAssumeSchemaIsValid\n        ? []\n        : validateSchema(newSchema);\n    const store = storeRef.current;\n    store.setState(({ requestCounter }) => ({\n      /**\n       * Increment the counter so that in-flight introspection requests don't\n       * override this change.\n       */\n      requestCounter: requestCounter + 1,\n      schema: newSchema,\n      shouldIntrospect: !isSchema(schema) && schema !== null,\n      validationErrors,\n    }));\n\n    // Trigger introspection\n    const { actions } = store.getState();\n    void actions.introspect();\n  }, [\n    schema,\n    dangerouslyAssumeSchemaIsValid,\n    fetcher, // should refresh schema with a new fetcher after a fetchError\n  ]);\n\n  /**\n   * Trigger introspection manually via a short key\n   */\n  useEffect(() => {\n    function runIntrospection(event: KeyboardEvent) {\n      if (event.ctrlKey && event.key === 'R') {\n        const { actions } = storeRef.current.getState();\n        void actions.introspect();\n      }\n    }\n\n    window.addEventListener('keydown', runIntrospection);\n    return () => {\n      window.removeEventListener('keydown', runIntrospection);\n    };\n  }, []);\n\n  return (\n    <GraphiQLContext.Provider value={storeRef}>\n      {children}\n    </GraphiQLContext.Provider>\n  );\n};\n\nexport function useGraphiQL<T>(selector: (state: SlicesWithActions) => T): T {\n  const store = useContext(GraphiQLContext);\n  if (!store) {\n    throw new Error(\n      `\"useGraphiQL\" hook must be used within a <GraphiQLProvider> component.\nIt looks like you are trying to use the hook outside the GraphiQL provider tree.`,\n    );\n  }\n  return useStore(store.current, useShallow(selector));\n}\n\n/**\n * Actions are functions used to update values in your store. They are static and never change.\n * @see https://tkdodo.eu/blog/working-with-zustand#separate-actions-from-state\n */\nexport const useGraphiQLActions = () => useGraphiQL(state => state.actions);\n\nfunction getExternalFragments(\n  externalFragments: GraphiQLProviderProps['externalFragments'],\n) {\n  const map = new Map<string, FragmentDefinitionNode>();\n  if (externalFragments) {\n    if (Array.isArray(externalFragments)) {\n      for (const fragment of externalFragments) {\n        map.set(fragment.name.value, fragment);\n      }\n    } else if (typeof externalFragments === 'string') {\n      visit(parse(externalFragments), {\n        FragmentDefinition(fragment) {\n          map.set(fragment.name.value, fragment);\n        },\n      });\n    } else {\n      throw new TypeError(\n        'The `externalFragments` prop must either be a string that contains the fragment definitions in SDL or a list of `FragmentDefinitionNode` objects.',\n      );\n    }\n  }\n  return map;\n}\n"],"names":["GraphiQLContext","createContext","GraphiQLProvider","props","$","_c","fetcher","TypeError","validationRules","query","variables","headers","response","actions","useMonaco","mounted","setMounted","useState","t0","initialize","t1","Symbol","for","useEffect","t2","InnerGraphiQLProvider","$storage","children","defaultHeaders","defaultTabs","externalFragments","getDefaultFieldNames","onCopyQuery","onEditOperationName","onSchemaChange","onTabChange","onTogglePluginVisibility","referencePlugin","schema","t10","t11","t3","t4","t5","t6","t7","t8","t9","visiblePlugin","defaultQuery","shouldPersistHeaders","onPrettifyQuery","dangerouslyAssumeSchemaIsValid","inputValueDeprecation","introspectionQueryName","schemaDescription","operationName","plugins","defaultTheme","editorTheme","storage","undefined","DEFAULT_QUERY","DEFAULT_PRETTIFY_QUERY","t12","MONACO_THEME_NAME","storeRef","useRef","uriInstanceId","useId","current","t13","initialHeaders","initialQuery","initialVariables","StorageAPI","getInitialVisiblePlugin","storedValue","get","STORAGE_KEY","pluginForStoredValue","find","plugin","title","set","getInitialTheme","stored","theme","getInitialState","tabs","activeTabIndex","getDefaultTabState","isStored","persistHeaders","$shouldPersistHeaders","store","create","t14","args","storageSlice","createStorageSlice","editorSlice","createEditorSlice","getExternalFragments","replaceAll","executionSlice","createExecutionSlice","overrideOperationName","pluginSlice","createPluginSlice","schemaSlice","createSchemaSlice","themeSlice","createThemeSlice","getState","storeTabs","setPlugins","setVisiblePlugin","setTheme","setState","useDidUpdate","t15","t16","actions_0","t17","newSchema","isSchema","validationErrors","validateSchema","store_0","t18","requestCounter","shouldIntrospect","actions_1","introspect","t19","t20","runIntrospection","event","ctrlKey","key","actions_2","addEventListener","removeEventListener","t21","useGraphiQL","selector","useContext","Error","useStore","useShallow","useGraphiQLActions","_temp","map","Map","Array","isArray","fragment","name","value","parse","FragmentDefinition","state"],"mappings":"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"}