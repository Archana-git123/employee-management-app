{"version":3,"file":"create-editor.js","sources":["../../src/utility/create-editor.ts"],"sourcesContent":["import type { KeyboardEventHandler, RefObject } from 'react';\nimport type * as monaco from 'monaco-editor';\nimport type { MonacoEditor } from '../types';\nimport { monacoStore } from '../stores';\nimport { Uri } from '../utility';\n\nexport const onEditorContainerKeyDown: KeyboardEventHandler<\n  HTMLDivElement\n> = event => {\n  const el = event.currentTarget;\n  const isFocused = el === document.activeElement;\n  if (isFocused && event.code === 'Enter') {\n    event.preventDefault();\n    el.querySelector('textarea')?.focus();\n  }\n};\n\nexport function getOrCreateModel({\n  uri: $uri,\n  value,\n}: {\n  uri: string;\n  value: string;\n}) {\n  const { monaco } = monacoStore.getState();\n  if (!monaco) {\n    throw new Error('Monaco editor is not initialized');\n  }\n  const uri = Uri.file($uri);\n  const model = monaco.editor.getModel(uri);\n  const language = uri.path.split('.').at(-1)!;\n  return model ?? monaco.editor.createModel(value, language, uri);\n}\n\nexport function createEditor(\n  domElement: RefObject<HTMLDivElement>,\n  options: monaco.editor.IStandaloneEditorConstructionOptions,\n): MonacoEditor {\n  const { model } = options;\n  if (!model) {\n    throw new Error('options.model is required');\n  }\n  const language = model.uri.path.split('.').at(-1)!;\n  const { monaco } = monacoStore.getState();\n  if (!monaco) {\n    throw new Error('Monaco editor is not initialized');\n  }\n  return monaco.editor.create(domElement.current, {\n    language,\n    automaticLayout: true,\n    fontSize: 15,\n    minimap: { enabled: false }, // disable the minimap\n    tabSize: 2,\n    renderLineHighlight: 'none', // Remove a line selection border\n    stickyScroll: { enabled: false }, // Disable sticky scroll widget\n    overviewRulerLanes: 0, // remove unnecessary error highlight on the scroll\n    scrollbar: {\n      verticalScrollbarSize: 10,\n    },\n    scrollBeyondLastLine: false, // cleans up unnecessary \"padding-bottom\" on each editor\n    fontFamily: '\"Fira Code\"',\n    // Enable font ligatures and fix incorrect caret position on Windows\n    // See: https://github.com/graphql/graphiql/issues/4040\n    fontLigatures: true,\n    lineNumbersMinChars: 2, // reduce line numbers width on the left size\n    tabIndex: -1, // Do not allow tabbing into the editor, only via by pressing Enter or its container\n    ...options,\n  });\n}\n"],"names":["onEditorContainerKeyDown","event","el","currentTarget","isFocused","document","activeElement","code","preventDefault","querySelector","focus","getOrCreateModel","uri","$uri","value","monaco","monacoStore","getState","Error","Uri","file","model","editor","getModel","language","path","split","at","createModel","createEditor","domElement","options","create","current","automaticLayout","fontSize","minimap","enabled","tabSize","renderLineHighlight","stickyScroll","overviewRulerLanes","scrollbar","verticalScrollbarSize","scrollBeyondLastLine","fontFamily","fontLigatures","lineNumbersMinChars","tabIndex"],"mappings":";;AAMO,MAAMA,2BAETC,CAAS,UAAA;;AACX,QAAMC,KAAKD,MAAME;AACXC,QAAAA,YAAYF,OAAOG,SAASC;AAC9BF,MAAAA,aAAaH,MAAMM,SAAS,SAAS;AACvCN,UAAMO,eAAe;AAClBC,aAAAA,cAAc,UAAU,MAAxBA,mBAA2BC;AAAAA,EAAM;AAExC;AAEO,SAASC,iBAAiB;AAAA,EAC/BC,KAAKC;AAAAA,EACLC;AAIF,GAAG;AACK,QAAA;AAAA,IAAEC;AAAAA,EAAAA,IAAWC,YAAYC,SAAS;AACxC,MAAI,CAACF,QAAQ;AACL,UAAA,IAAIG,MAAM,kCAAkC;AAAA,EAAA;AAE9CN,QAAAA,MAAMO,IAAIC,KAAKP,IAAI;AACzB,QAAMQ,QAAQN,OAAOO,OAAOC,SAASX,GAAG;AACxC,QAAMY,WAAWZ,IAAIa,KAAKC,MAAM,GAAG,EAAEC,GAAG,EAAE;AAC1C,SAAON,SAASN,OAAOO,OAAOM,YAAYd,OAAOU,UAAUZ,GAAG;AAChE;AAEgBiB,SAAAA,aACdC,YACAC,SACc;AACR,QAAA;AAAA,IAAEV;AAAAA,EAAAA,IAAUU;AAClB,MAAI,CAACV,OAAO;AACJ,UAAA,IAAIH,MAAM,2BAA2B;AAAA,EAAA;AAEvCM,QAAAA,WAAWH,MAAMT,IAAIa,KAAKC,MAAM,GAAG,EAAEC,GAAG,EAAE;AAC1C,QAAA;AAAA,IAAEZ;AAAAA,EAAAA,IAAWC,YAAYC,SAAS;AACxC,MAAI,CAACF,QAAQ;AACL,UAAA,IAAIG,MAAM,kCAAkC;AAAA,EAAA;AAEpD,SAAOH,OAAOO,OAAOU,OAAOF,WAAWG,SAAS;AAAA,IAC9CT;AAAAA,IACAU,iBAAiB;AAAA,IACjBC,UAAU;AAAA,IACVC,SAAS;AAAA,MAAEC,SAAS;AAAA,IAAM;AAAA;AAAA,IAC1BC,SAAS;AAAA,IACTC,qBAAqB;AAAA;AAAA,IACrBC,cAAc;AAAA,MAAEH,SAAS;AAAA,IAAM;AAAA;AAAA,IAC/BI,oBAAoB;AAAA;AAAA,IACpBC,WAAW;AAAA,MACTC,uBAAuB;AAAA,IACzB;AAAA,IACAC,sBAAsB;AAAA;AAAA,IACtBC,YAAY;AAAA;AAAA;AAAA,IAGZC,eAAe;AAAA,IACfC,qBAAqB;AAAA;AAAA,IACrBC,UAAU;AAAA;AAAA,IACV,GAAGjB;AAAAA,EAAAA,CACJ;AACH;"}